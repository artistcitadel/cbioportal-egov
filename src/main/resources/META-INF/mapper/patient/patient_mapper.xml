<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="patientcpm">

    <select id="selectPatientChoiceList" parameterType="map" resultType="hashmap">
      SELECT DISTINCT
                RESCH_PAT_ID patientId,
                'xxxx' sampleId,
                '9999' age,
                'xxxx' cancerStudies,
                'xxxxx' cancerType,
                'xxxx' cancerTypeDetails
     FROM CLSPNEXRT
    </select>

    <select id="selectLabTestHrc" parameterType="map" resultType="hashmap">
      SELECT DISTINCT
                'Lab_test' subject,
                EXAM_CD id,
                IFNULL(EXAM_ENG_NM, EXAM_CD) name
                FROM CLSPNEXRT
      <![CDATA[
        WHERE LENGTH(EXAM_CD) < 6
      ]]>
    </select>

    <select id="selectLabTest" parameterType="map" resultType="hashmap">
     SELECT
     'Lab_test' subject,
     EXAM_SLIP_CD pid ,
                         EXAM_CD id,
                         EXAM_ENG_NM name,
                         RCEP_DT time,
                         ROUND(SUM(EXAM_RSLT_VAL),2) exam,
                         ROUND(SUM(MARK_RSLT_VAL),2) mark,
                         ROUND(IFNULL(SUM(CRTE_MSR_VAL),0),2)  crte

        FROM CLSPNEXRT
        WHERE RESCH_PAT_ID = '6905950076' AND EXAM_CD IN ('DA0036','BD0012','BA0094') AND SUBSTRING(RCEP_DT,1,4) = '2017' OR (EXAM_CD='BD0012' AND RCEP_DT='20040427')
        GROUP BY EXAM_SLIP_CD, EXAM_CD, EXAM_ENG_NM, RCEP_DT
        ORDER BY 2,3,5
        LIMIT  10000
 	</select>

</mapper>



<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC
        "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">


<mapper namespace="patientcpm">

    <select id="selectLabTestHrc" parameterType="map" resultType="hashmap">
      SELECT DISTINCT EXAM_CD id,
                EXAM_ENG_NM name
                FROM CLSPNEXRT
      <![CDATA[
        WHERE LENGTH(EXAM_CD) < 6
      ]]>
    </select>

    <select id="selectLabTest" parameterType="map" resultType="hashmap">
     SELECT
     'Lab_test' subject,
     EXAM_SLIP_CD pid ,
                         EXAM_CD id,
                         EXAM_ENG_NM name,
                         RCEP_DT time,
                         SUM(EXAM_RSLT_VAL) exam,
                         SUM(MARK_RSLT_VAL) mark,
                         IFNULL(SUM(CRTE_MSR_VAL),0)  crte

        FROM CLSPNEXRT
        WHERE RESCH_PAT_ID = #{patientId}
        GROUP BY EXAM_SLIP_CD, EXAM_CD, EXAM_ENG_NM, RCEP_DT
        LIMIT  10
 	</select>

    <select id="selectLabTestSpec" parameterType="map" resultType="hashmap">
    SELECT    'LAB_TEST' subject,
                EXAM_CD id ,
                EXAM_ENG_NM name,
                EXAM_RSLT_VAL exam,
                MARK_RSLT_VAL mark,
                CRTE_MSR_VAL crte,
                RCEP_DT time
                FROM CLSPNEXRT
                WHERE RESCH_PAT_ID = #{patientId}
                AND LENGTH(EXAM_CD) = '6'
                /*and exam_cd in('BB0013','BC0001')*/
                ORDER BY 2, 6
                LIMIT  5
    </select>
</mapper>


